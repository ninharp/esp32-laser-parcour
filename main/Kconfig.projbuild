menu "Laser Parcour Configuration"

    choice MODULE_ROLE
        prompt "Module Role"
        default MODULE_ROLE_CONTROL
        help
            Select the role of this module in the laser parcour system.

        config MODULE_ROLE_CONTROL
            bool "Main Unit"
            help
                Central game controller managing game state and coordination.
                Runs web server and OLED display.

        config MODULE_ROLE_LASER
            bool "Laser Unit"
            help
                Combined laser emitter and sensor unit that controls laser diode
                and detects beam interruptions.
    endchoice

    config MODULE_ID
        int "Module ID"
        range 1 255
        default 1
        help
            Unique identifier for this module (1-255).
            Main Unit typically uses ID 1.
            Laser Units use IDs 2-20.
            
            Note: If migrating from a previous version where sensors and lasers
            were separate, you may need to reconfigure module IDs.

    config DEVICE_NAME
        string "Device Name"
        default "ESP32-LaserModule"
        help
            Custom name for this device (shown in web interface).

    menu "Network Settings"

        config WIFI_SSID
            string "WiFi SSID"
            default "ESP32-LaserParcour"
            help
                SSID for WiFi Access Point (Control module only).

        config WIFI_PASSWORD
            string "WiFi Password"
            default "lasergame"
            help
                Password for WiFi Access Point (minimum 8 characters).

        config WIFI_CHANNEL
            int "WiFi Channel"
            range 1 13
            default 1
            help
                WiFi channel for both AP and ESP-NOW (must match on all modules).

        config MAX_STA_CONN
            int "Maximum Simultaneous Connections"
            range 1 4
            default 4
            help
                Maximum number of stations that can connect to AP.

        config ESPNOW_CHANNEL
            int "ESP-NOW Channel"
            range 1 13
            default 1
            help
                Channel for ESP-NOW communication (must match WiFi channel).

        config MAX_ESPNOW_PEERS
            int "Maximum ESP-NOW Peers"
            range 1 20
            default 20
            help
                Maximum number of ESP-NOW peers (connected modules).

    endmenu

    menu "Game Parameters"

        config GAME_DURATION
            int "Default Game Duration (seconds)"
            range 30 600
            default 180
            help
                Default game duration in seconds (3 minutes = 180).

        config PENALTY_TIME
            int "Beam Break Penalty (seconds)"
            range 0 30
            default 5
            help
                Time penalty in seconds for each beam break.

        config COUNTDOWN_DURATION
            int "Pre-Game Countdown (seconds)"
            range 3 10
            default 5
            help
                Countdown duration before game starts.

        config BASE_SCORE
            int "Base Score"
            range 0 10000
            default 1000
            help
                Starting score for each game.

        config TIME_BONUS_MULTIPLIER
            int "Time Bonus Multiplier"
            range 0 100
            default 10
            help
                Points awarded per second of time remaining.

        config PENALTY_POINTS
            int "Penalty Points (negative)"
            range -1000 0
            default -50
            help
                Points deducted per beam break (use negative number).

    endmenu

    menu "Hardware Configuration"

        config ENABLE_DISPLAY
            bool "Enable OLED Display"
            default y
            depends on MODULE_ROLE_CONTROL
            help
                Enable OLED display support. Disable this if running headless
                with web interface only.

        choice OLED_TYPE
            prompt "OLED Display Type"
            default OLED_SSD1306
            depends on MODULE_ROLE_CONTROL && ENABLE_DISPLAY
            help
                Type of OLED display controller.

            config OLED_SSD1306
                bool "SSD1306"
            config OLED_SH1106
                bool "SH1106"
        endchoice

        config I2C_SDA_PIN
            int "I2C SDA Pin"
            range -1 21
            default 19
            depends on MODULE_ROLE_CONTROL && ENABLE_DISPLAY
            help
                GPIO pin for I2C data line (SDA).
                Set to -1 to disable display.
                Note: GPIO18-19 are used for USB on some boards.
                Recommended: GPIO0-10, GPIO20-21.

        config I2C_SCL_PIN
            int "I2C SCL Pin"
            range -1 21
            default 18
            depends on MODULE_ROLE_CONTROL && ENABLE_DISPLAY
            help
                GPIO pin for I2C clock line (SCL).
                Set to -1 to disable display.
                Note: GPIO18-19 are used for USB on some boards.
                Recommended: GPIO0-10, GPIO20-21.

        config I2C_FREQUENCY
            int "I2C Frequency (Hz)"
            range 100000 400000
            default 100000
            depends on MODULE_ROLE_CONTROL && ENABLE_DISPLAY
            help
                I2C bus frequency in Hz (100kHz or 400kHz).

        config ENABLE_BUTTONS
            bool "Enable Physical Buttons"
            default y
            depends on MODULE_ROLE_CONTROL
            help
                Enable physical button support. Disable this if controlling
                only via web interface.

        config BUTTON1_PIN
            int "Button 1 Pin (Start/Stop)"
            range -1 21
            default 1
            depends on MODULE_ROLE_CONTROL && ENABLE_BUTTONS
            help
                GPIO pin for Button 1 (Start/Stop game).
                Set to -1 to disable this button.

        config BUTTON2_PIN
            int "Button 2 Pin (Mode Select)"
            range -1 21
            default 3
            depends on MODULE_ROLE_CONTROL && ENABLE_BUTTONS
            help
                GPIO pin for Button 2 (Mode selection).
                Set to -1 to disable this button.

        config BUTTON3_PIN
            int "Button 3 Pin (Reset)"
            range -1 21
            default 7
            depends on MODULE_ROLE_CONTROL && ENABLE_BUTTONS
            help
                GPIO pin for Button 3 (Reset score).
                Set to -1 to disable this button.

        config BUTTON4_PIN
            int "Button 4 Pin (Confirm)"
            range -1 21
            default 6
            depends on MODULE_ROLE_CONTROL && ENABLE_BUTTONS
            help
                GPIO pin for Button 4 (Confirm selection).
                Set to -1 to disable this button.

        config ENABLE_BUZZER
            bool "Enable Buzzer"
            default y
            depends on MODULE_ROLE_CONTROL
            help
                Enable buzzer/speaker for audio feedback.

        config BUZZER_PIN
            int "Buzzer Pin"
            range -1 21
            default 5
            depends on MODULE_ROLE_CONTROL && ENABLE_BUZZER
            help
                GPIO pin for buzzer/speaker output.
                Set to -1 to disable buzzer.

        config LASER_PIN
            int "Laser Control Pin"
            range 0 21
            default 2
            depends on MODULE_ROLE_LASER
            help
                GPIO pin for laser diode control (PWM capable).

        config LASER_STATUS_LED_PIN
            int "Laser Status LED Pin"
            range 0 21
            default 21
            depends on MODULE_ROLE_LASER
            help
                GPIO pin for status LED on laser unit.

        config SENSOR_PIN
            int "Photoresistor ADC Pin"
            range 0 4
            default 4
            depends on MODULE_ROLE_LASER
            help
                ADC channel for photoresistor (GPIO0-4 = ADC1_CH0-4).
                The sensor is integrated in the laser unit.

        config SENSOR_LED_GREEN_PIN
            int "Sensor Green LED Pin"
            range 0 21
            default 20
            depends on MODULE_ROLE_LASER
            help
                GPIO pin for green status LED (beam detected).

        config SENSOR_LED_RED_PIN
            int "Sensor Red LED Pin"
            range 0 21
            default 10
            depends on MODULE_ROLE_LASER
            help
                GPIO pin for red status LED (beam broken).

        config SENSOR_THRESHOLD
            int "Beam Detection Threshold"
            range 0 4095
            default 2000
            depends on MODULE_ROLE_LASER
            help
                ADC threshold for detecting beam break (0-4095, 12-bit ADC).
                For LDR with laser: Set between no-laser value (~850) and laser value (~4095).
                Recommended: 2000. ADC above threshold = beam present, below = beam broken.

        config DEBOUNCE_TIME
            int "Debounce Time (ms)"
            range 10 1000
            default 100
            help
                Debounce delay in milliseconds for buttons and sensors.

    endmenu

endmenu
